<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Catatan kecil Andi."><link rel="shortcut icon" href=https://akherlan.github.io/favicon.ico><link rel=stylesheet href=/css/style.min.css><link rel=canonical href=https://akherlan.github.io/visualisasi-ketersediaan-data-hujan/><title>Visualisasi Ketersediaan Data Hujan</title></head><body><header id=banner><h2><a href=https://akherlan.github.io/>Notebook</a></h2><nav><ul><li><a href=/about/ title=about>about</a></li><li><a href=/now/ title=now>now</a></li><li><a href=/read/ title=read>read</a></li><li><a href=/index.xml title=rss>rss</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Visualisasi Ketersediaan Data Hujan</h1><div><time>11 Agustus 2019</time></div></header><h2 id=objective>Objective</h2><p>Tutorial ini merupakan catatan pengingat bagi saya. Kan, syukur kalau bisa dibagi ke teman-teman semua. Tujuan tutorialnya adalah untuk membuat visualisasi &ldquo;kekosongan&rdquo; data hujan yang saya miliki. Atau dengan kata lain untuk mengetahui berapa persen <em>sih</em> kelengkapannya?</p><p>Harapannya: agar tahu mana yang masih harus dilegkapi. Juga bisa memilih data hujan mana, serta data hujan kapan yang bisa saya gunakan untuk tahap analisis berikutnya.</p><h2 id=preparation>Preparation</h2><p>Yang kita butuhkan untuk melakukan ini semua tentu saja <strong>data</strong> hujan. Saya menyimpannya dalam format <code>.Rda</code>. Sebenarnya juga bisa dari <code>.csv</code> atau <code>.xls</code>, tapi kalau dalam format data R tentu lebih rapi. Jadi saya pakai itu. Data hujan yang saya gunakan ini juga sudah bisa teman-teman akses <a href=#>dari tadi</a> sebenarnya. Resolusi datanya hujan harian.</p><p>Selain data, kita juga butuh beberapa paket <em>library</em> untuk manipulasi. Makna manipulasi di sini bukan &ldquo;memalsukan&rdquo;, tetapi &ldquo;ngotak-ngatik&rdquo;.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=c1># library yang dibutuhkan</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>dplyr</span><span class=p>)</span>         <span class=c1># manipulasi data</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>lubridate</span><span class=p>)</span>     <span class=c1># manipulasi tanggal</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>ggplot2</span><span class=p>)</span>       <span class=c1># plot grafik</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># memuat data, sesuaikan lokasi file</span>
</span></span><span class=line><span class=cl><span class=nf>load</span><span class=p>(</span><span class=n>file</span> <span class=o>=</span> <span class=s>&#34;~/R/repo/hujan/data/prc/Raingauge/Precip.Rda&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># menghilangkan hari yang kosong (aneh, ya?)</span>
</span></span><span class=line><span class=cl><span class=n>Precip</span> <span class=o>&lt;-</span> <span class=n>Precip[</span><span class=o>!</span><span class=nf>is.na</span><span class=p>(</span><span class=n>Precip</span><span class=o>$</span><span class=n>tgl</span><span class=p>),</span><span class=n>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># kategorisasi nama stasiun</span>
</span></span><span class=line><span class=cl><span class=n>Precip</span><span class=o>$</span><span class=n>NamaStasiun</span> <span class=o>&lt;-</span> <span class=nf>as.factor</span><span class=p>(</span><span class=n>Precip</span><span class=o>$</span><span class=n>NamaStasiun</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>summary</span><span class=p>(</span><span class=n>Precip</span><span class=p>)</span>
</span></span></code></pre></div><p>Data ini sudah saya rapikan sebelumnya. Agar teman-teman bisa mengakses data ini dari RStudio di komputer masing-masing, silakan sesuaikan nilai <code>"~/R/repo/hujan/data/precip.Rda"</code> dengan direktori yang tepat sesuai lokasi teman-teman menyimpannya.</p><p>Simpan dalam hati? Oh, jangan.</p><p>Kembali ke laptop!</p><p>Kalau diperhatikan dari hasil <code>summary</code> data, kolom tanggal (<strong>tgl</strong>) dan kolom curah hujan (<strong>prc</strong>) sudah tidak ada data kosong (<em>NA</em>) seperti pada <strong>(LONx, LATy)</strong>. Tetapi, sebenarnya ada beberapa tanggal yang data hujannya memang kosong. Hanya saja saya hilangkan.</p><p>Maka berikutnya, kita akan menghitung jumlah stasiun yang punya rekaman data pada hari X. <em>Check it out!</em></p><h2 id=counting-data>Counting Data</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>p.mod</span> <span class=o>&lt;-</span> <span class=n>Precip</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=nf>group_by</span><span class=p>(</span><span class=n>tgl</span><span class=p>)</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=nf>summarise</span><span class=p>(</span><span class=n>count</span> <span class=o>=</span> <span class=nf>sum</span><span class=p>(</span><span class=nf>as.numeric</span><span class=p>(</span><span class=nf>ifelse</span><span class=p>(</span><span class=o>!</span><span class=nf>is.na</span><span class=p>(</span><span class=n>prc</span><span class=p>),</span> <span class=n>yes</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> <span class=n>no</span> <span class=o>=</span> <span class=m>0</span><span class=p>))))</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=nf>mutate</span><span class=p>(</span><span class=n>persen</span> <span class=o>=</span> <span class=p>(</span><span class=n>count</span> <span class=o>/</span> <span class=nf>nlevels</span><span class=p>(</span><span class=n>Precip</span><span class=o>$</span><span class=n>NamaStasiun</span><span class=p>))</span><span class=o>*</span><span class=m>100</span><span class=p>)</span>
</span></span></code></pre></div><p>Baris kode di atas akan membuat tabel baru bernama <strong>p.mod</strong>, yang merupakan ringkasan dari tabel <strong>Precip</strong> dengan nilai-nilai yang kita butuhkan untuk membuat visualisasi.</p><ol><li>Bagian <code>count = ...</code> bertujuan untuk membuat kolom baru yang berisi hasil hitungan jumlah data. Jika pada hari X stasiun hujan Q memiliki rekaman data, maka dihitung satu. Termasuk data nol (0 bukan NA).</li><li>Bagian <code>persen = ...</code> adalah untuk membuat kolom baru yang berisi perhitungan persentase data hujan harian yang tersedia dari ke-19 stasiun hujan yang digunakan datanya. Jumlah stasiun yang punya data harian (nilai dalam masing-masing cell pada kolom <strong>count</strong>) dibagi dengan jumlah stasiun (<code>nlevels(Precip$NamaStasiun)</code>) kemudian dikali 100 persen.</li></ol><p>Kalau kita lihat struktur tabel <strong>p.mod</strong> itu seperti berikut.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=nf>str</span><span class=p>(</span><span class=n>p.mod</span><span class=p>)</span>   <span class=c1># struktur data</span>
</span></span></code></pre></div><p>Kalau dilihat dalam bentuk tabel, seperti di bawah ini.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=nf>head</span><span class=p>(</span><span class=n>p.mod</span><span class=p>)</span>   <span class=c1># menampilkan 6 rekaman data teratas</span>
</span></span></code></pre></div><h2 id=plotting>Plotting</h2><p>Tiba saatnya untuk <em>plotting</em> grafik. Waktu yang ditunggu-tunggu. Berikut baris data yang digunakan.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>p.mod</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl><span class=nf>mutate</span><span class=p>(</span><span class=n>bulan</span> <span class=o>=</span> <span class=nf>month</span><span class=p>(</span><span class=n>tgl</span><span class=p>,</span> <span class=n>label</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>abbr</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>tahun</span>  <span class=o>=</span> <span class=nf>year</span><span class=p>(</span><span class=n>tgl</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>hari</span>   <span class=o>=</span> <span class=nf>wday</span><span class=p>(</span><span class=n>tgl</span><span class=p>,</span><span class=n>label</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>pekan</span>  <span class=o>=</span> <span class=nf>ceiling</span><span class=p>(</span><span class=nf>day</span><span class=p>(</span><span class=n>tgl</span><span class=p>)</span><span class=o>/</span><span class=m>7</span><span class=p>))</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>      <span class=nf>group_by</span><span class=p>(</span><span class=n>bulan</span><span class=p>,</span> <span class=n>tahun</span><span class=p>,</span> <span class=n>hari</span><span class=p>,</span> <span class=n>pekan</span><span class=p>)</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nf>ggplot</span><span class=p>()</span> <span class=o>+</span> <span class=nf>aes</span><span class=p>(</span> <span class=n>hari</span><span class=p>,</span> <span class=n>pekan</span><span class=p>,</span> <span class=n>fill</span> <span class=o>=</span> <span class=n>persen</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_tile</span><span class=p>(</span><span class=n>colour</span> <span class=o>=</span> <span class=s>&#34;white&#34;</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>facet_grid</span><span class=p>(</span><span class=n>tahun</span><span class=o>~</span><span class=n>bulan</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>scale_fill_gradient2</span><span class=p>(</span><span class=n>low</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>,</span> <span class=n>mid</span><span class=o>=</span><span class=s>&#34;yellow&#34;</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                         <span class=n>na.value</span> <span class=o>=</span> <span class=s>&#34;grey70&#34;</span><span class=p>,</span> <span class=n>midpoint</span><span class=o>=</span><span class=m>50</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>theme</span><span class=p>(</span><span class=n>axis.title</span><span class=o>=</span><span class=nf>element_blank</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.text</span><span class=o>=</span><span class=nf>element_blank</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.ticks</span><span class=o>=</span><span class=nf>element_blank</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>          <span class=n>strip.text</span><span class=o>=</span><span class=nf>element_text</span><span class=p>(</span><span class=n>angle</span><span class=o>=</span><span class=m>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>strip.text.y</span><span class=o>=</span><span class=nf>element_text</span><span class=p>(</span><span class=n>angle</span><span class=o>=</span><span class=m>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>panel.spacing</span> <span class=o>=</span> <span class=nf>unit</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=s>&#34;lines&#34;</span><span class=p>))</span>
</span></span></code></pre></div><p>Taraaaaa, jadi.</p><script async src=https://telegram.org/js/telegram-widget.js?14 data-telegram-post=teknologimasagitu/11 data-width=100% data-userpic=false></script><h2 id=conclusion>Conclusion</h2><p>Hhmmm&mldr; Data paling lengkap sepertinya pada 2009. Sepakat? Atau kita eliminasi saja stasiun hujannya. Hahaha&mldr; Pada 2013 terjadi ke-ompong-an. Kita pakai 2004-2009 saja, bagaimana?</p><p>Terima kasih. Semoga bermanfaat.</p><h2 id=reference>Reference</h2><ul><li>Manuel Gimond&rsquo;s note <a href=https://mgimond.github.io/meteo_waterville/>here</a></li></ul></article></main><footer id=footer>Powered by Hugo and Github Page.</footer><script type=text/javascript src=https://akherlan.github.io/js/annotate.min.5b4a25824103cc64465094e19cc2320c441bfb502095d340b33f9b9b252657f00a1f08fdbb369fa15ca73ce0db9fb60e5f78935a6954e5d2371ef3e7b0a4b281.js integrity="sha512-W0olgkEDzGRGUJThnMIyDEQb+1AgldNAsz+bmyUmV/AKHwj9uzafoVynPODbn7YOX3iTWmlU5dI3HvPnsKSygQ=="></script></body></html>